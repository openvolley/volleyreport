```{r}
if (vsx$shiny_progress) try(shiny::setProgress(value = 0.3, message = "Generating header"), silent = TRUE)
```

```{r mr1html, warning = FALSE, results = "asis"}
if (!is.null(vsx$icon)) {
    cat("<div class=\"row\">\n")
    cat("<div class=\"col-sm-2 col\" style=\"padding-right: 0px;\">")
    cat("<img src=\"", vsx$icon, "\" style=\"max-width: 100%; max-height: 100%;\" />\n", sep = "")
    cat("</div>\n")
    cat("<div class=\"col-sm-10 col\">")
}

cat("<div class=\"row\" style=\"border:1px;\">\n")

cat("<div class=\"col-sm-4 col\">")
vsx$meta$teams %>% dplyr::select(team, sets_won) %>% 
    dplyr::rename(Teams = team, 'Final score' = sets_won) %>%
    kable(format = kable_format, escape = FALSE, col.names = c("MATCH RESULT", "")) %>% kable_styling(bootstrap_options = c("striped", "hover"), full_width = TRUE, font_size = 15) %>%
      row_spec(1:2, bold = TRUE) %>%
      row_spec(0, bold = TRUE, color = vsx$css$header_colour, background = vsx$css$header_background ) %>%
    column_spec(1, border_left = vsx$css$border) %>% 
    column_spec(2, border_right = vsx$css$border)
cat("</div>\n")

cat("<div class=\"col-sm-2 col\">")
kable(vsx$meta$match %>% dplyr::select(date, time, season, league) %>% mutate_all(as.character) %>% pivot_longer(cols = 1:4) %>% 
            mutate(name = str_to_title(name)),
            format = kable_format, escape = FALSE, align = "l",col.names = NULL) %>%
      kable_styling(bootstrap_options = c("condensed"), full_width = TRUE, font_size = 9) %>%
      column_spec(1, bold = T)
cat("</div>\n")

cat("<div class=\"col-sm-2 col\">")
kable(vsx$meta$more %>% dplyr::select(referees, city, arena, scout) %>% mutate_all(as.character) %>% pivot_longer(cols = 1:4) %>%
            mutate(name = str_to_title(name)),
            format = kable_format, escape = FALSE, align = "l",col.names = NULL) %>%
      kable_styling(bootstrap_options = c("condensed"), full_width = TRUE, font_size = 9) %>%
      column_spec(1, bold = TRUE)
cat("</div>\n")

cat("<div class=\"col-sm-4 col\">")
vsx$meta$result %>% 
      mutate(Set = 1:nrow(.),
             'Partial score' = paste(score_intermediate1,score_intermediate2,score_intermediate3)) %>%
      dplyr::rename(Duration = duration, Score = score) %>% dplyr::select(Set, Duration, 'Partial score', Score) %>% 
      kable(format = kable_format, escape = FALSE, align = "r") %>%
      kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = TRUE, font_size = 11) %>%
      row_spec(0, bold = TRUE, color = vsx$css$header_colour, background = vsx$css$header_background) %>%
      column_spec(1:2, width = "0.5in") %>%
     column_spec(1, border_left = vsx$css$border) %>% 
    column_spec(4, border_right = vsx$css$border)
cat("</div>\n")
cat("</div>\n")
if (!is.null(vsx$icon)) {
    cat("</div></div>\n")
}
```

